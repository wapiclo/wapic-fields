(()=>{class e{constructor(){this.init()}showError(e,i){var t=e.closest(".wcf-field"),e=document.getElementById(e.id+"_error");e&&(t.classList.add("has-field-error"),e.textContent=i,e.style.display="block")}clearError(e){var i=e.closest(".wcf-field"),e=document.getElementById(e.id+"_error");e&&(i.classList.remove("has-field-error"),e.textContent="",e.style.display="none")}isNumber(e){return/^\d+(\.\d+)?$/.test(e.trim())}isEmail(e){return/^\S+@\S+\.\S+$/.test(e.trim())}isURL(e){return/^https?:\/\//i.test(e)||/^#[\w-]*$/.test(e)}validateField(e){var i=e.value.trim();if((e.hasAttribute("required")||e.hasAttribute("data-required"))&&""===i)return this.showError(e,wapic_field.validation.requiredMessage),!1;if(""!==i){if(e.classList.contains("wcf-field-email")&&!this.isEmail(i))return this.showError(e,wapic_field.validation.validEmail),!1;if(e.classList.contains("wcf-field-number")||e.classList.contains("wcf-field-phone")){if(!this.isNumber(i))return this.showError(e,wapic_field.validation.validNumber),!1;var t=e.getAttribute("min"),r=e.getAttribute("max"),a=parseFloat(i);if(null!==t&&a<parseFloat(t))return this.showError(e,wapic_field.validation.minNumber.replace("%s",t)),!1;if(null!==r&&a>parseFloat(r))return this.showError(e,wapic_field.validation.maxNumber.replace("%s",r)),!1}if(e.classList.contains("wcf-field-url")&&!this.isURL(i))return this.showError(e,wapic_field.validation.validUrl),!1;if(e.classList.contains("wcf-field-file-url")&&!this.isURL(i))return this.showError(e,wapic_field.validation.validUrl),!1;if(t=e.closest(".wcf-field").classList.contains("regular-price"),a=e.closest(".wcf-field").classList.contains("sale-price"),t||a){r=document.querySelector(".regular-price input"),i=document.querySelector(".sale-price input");if(this.showError(r,wapic_field.validation.compareRegularPrice),this.showError(i,wapic_field.validation.compareSalePrice),r&&i&&this.isNumber(r.value)&&this.isNumber(i.value)){if(parseFloat(i.value)>parseFloat(r.value))return this.showError(r,wapic_field.validation.compareRegularPrice),this.showError(i,wapic_field.validation.compareSalePrice),!1;this.clearError(r),this.clearError(i)}}}return this.clearError(e),!0}handleFormSubmit(e){var i=e.target,t=i.querySelectorAll(".wcf-field input, .wcf-field textarea, .wcf-field select");let r=!0,a=[];t.forEach(e=>{var i,t;this.validateField(e)||(r=!1,i=(i=document.getElementById(e.id+"_error"))?i.textContent.trim():"",t=(t=document.querySelector(`label[for="${e.id}"]`))?t.textContent.trim():e.name||e.id,""!==i&&a.push(t+": "+i))}),!r&&(e.preventDefault(),a=[...new Set(a)],t=wapic_field.validation.submitFailed+`

`+a.map((e,i)=>i+1+". "+e).join("\n"),alert(t),e=i.querySelector(".has-field-error"))&&e.scrollIntoView({behavior:"smooth",block:"center"})}onInputChange(e){e.target.matches(".wcf-field input, .wcf-field textarea, .wcf-field select")&&this.validateField(e.target)}onFormSubmit(e){this.handleFormSubmit(e)}init(){document.addEventListener("input",this.onInputChange.bind(this)),document.querySelectorAll("form#post, form#option, form#addtag, form#edittag").forEach(e=>{e.addEventListener("submit",e=>this.onFormSubmit(e))}),document.querySelectorAll(".wcf-field input, .wcf-field textarea, .wcf-field select").forEach(e=>{this.validateField(e)})}}document.addEventListener("DOMContentLoaded",()=>{new e})})();
//# sourceMappingURL=validation.min.js.map
