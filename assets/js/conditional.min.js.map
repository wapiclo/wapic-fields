{"version":3,"file":"conditional.min.js","sources":["conditional.js"],"sourcesContent":["    // Handle conditional fields\n    function WapicFieldConditionalFields() {\n        // Initial check for all fields\n        document.querySelectorAll('[data-condition-field], [data-cond-field]').forEach(function (wrapper) {\n            checkCondition(wrapper);\n        });\n    }\n\n    function checkCondition(wrapper) {\n        var condField = wrapper.getAttribute('data-condition-field') || wrapper.getAttribute('data-cond-field');\n        var condValue = wrapper.getAttribute('data-condition-value') || wrapper.getAttribute('data-cond-value');\n        var operator = wrapper.getAttribute('data-condition-operator') || '==';\n\n        if (!condField) return;\n\n        // Find trigger element\n        // 1. Try by ID\n        var trigger = document.getElementById(condField);\n        \n        // 2. Try by name (more robust for repeaters)\n        if (!trigger) {\n            // If we are inside a repeater row, try to find the field within the same row first\n            var row = wrapper.closest('.wcf-repeater-row');\n            if (row) {\n                // Try to find input with name ending in [condField]\n                trigger = row.querySelector('[name$=\"[' + condField + ']\"]');\n                if (!trigger) {\n                     // Try to find input with data-field-id\n                     trigger = row.querySelector('[data-field-id=\"' + condField + '\"] input, [data-field-id=\"' + condField + '\"] select, [data-field-id=\"' + condField + '\"] textarea');\n                }\n            }\n        }\n\n        // 3. Fallback to global query\n        if (!trigger) {\n            trigger = document.querySelector('[name=\"' + condField + '\"]');\n        }\n        \n        if (!trigger) return;\n\n        var currentValue = '';\n        if (trigger.type === 'checkbox') {\n            currentValue = trigger.checked ? trigger.value : '';\n            // If checkbox is unchecked, value is usually empty or 0, but let's handle \"yes\" convention\n            if (!trigger.checked && trigger.value === 'yes') currentValue = ''; \n        } else if (trigger.type === 'radio') {\n            // For radio, we need to find the checked one in the same group\n            var radioName = trigger.name;\n            var checkedRadio = document.querySelector('input[name=\"' + radioName + '\"]:checked');\n            currentValue = checkedRadio ? checkedRadio.value : '';\n        } else {\n            currentValue = trigger.value;\n        }\n\n        var isMatch = false;\n        if (operator === '==') {\n            isMatch = String(currentValue) === String(condValue);\n        } else if (operator === '!=') {\n            isMatch = String(currentValue) !== String(condValue);\n        }\n        // Add more operators if needed\n\n        if (isMatch) {\n            wrapper.hidden = false;\n            // Restore original input types\n            wrapper.querySelectorAll('input[data-original-type]').forEach(function (input) {\n                input.type = input.getAttribute('data-original-type');\n                input.removeAttribute('data-original-type');\n                // Remove hidden flag if it exists\n                const hiddenFlag = wrapper.querySelector('input[name=\"' + input.name + '_is_hidden\"]');\n                if (hiddenFlag) {\n                    hiddenFlag.remove();\n                }\n            });\n        } else {\n            wrapper.hidden = true;\n            // Store original input type and change to hidden\n            wrapper.querySelectorAll('input:not([type=\"hidden\"])').forEach(function (input) {\n                if (!input.hasAttribute('data-original-type')) {\n                    input.setAttribute('data-original-type', input.type);\n                    input.type = 'hidden';\n                    // Add hidden flag for the server-side\n                    const hiddenFlag = document.createElement('input');\n                    hiddenFlag.type = 'hidden';\n                    hiddenFlag.name = input.name + '_is_hidden';\n                    hiddenFlag.value = '1';\n                    wrapper.appendChild(hiddenFlag);\n                }\n            });\n        }\n    }\n\n    function WapicFieldConditionalFieldsInit() {\n        WapicFieldConditionalFields();\n\n        // Use event delegation for dynamic fields\n        document.addEventListener('change', function(e) {\n            var target = e.target;\n            if (target.matches('input, select, textarea')) {\n                // When any input changes, re-check all conditions\n                // Optimization: We could try to find only dependent fields, but checking all is safer for now\n                WapicFieldConditionalFields();\n            }\n        });\n        \n        // Also listen for input event for immediate feedback on text inputs if desired, \n        // but change is usually enough for conditional logic triggers (select, radio, checkbox)\n    }\n\n    document.addEventListener('DOMContentLoaded', WapicFieldConditionalFieldsInit);"],"names":["WapicFieldConditionalFields","document","querySelectorAll","forEach","wrapper","checkCondition","trigger","currentValue","condField","getAttribute","condValue","operator","getElementById","row","closest","querySelector","type","checked","value","radioName","name","checkedRadio","isMatch","String","hidden","input","removeAttribute","hiddenFlag","remove","hasAttribute","setAttribute","createElement","appendChild","WapicFieldConditionalFieldsInit","addEventListener","e","target","matches"],"mappings":"AACI,SAASA,8BAELC,SAASC,iBAAiB,2CAA2C,EAAEC,QAAQ,SAAUC,GACrFC,eAAeD,CAAO,CAC1B,CAAC,CACL,CAEA,SAASC,eAAeD,GACpB,IAQIE,EAgCAC,EAxCAC,EAAYJ,EAAQK,aAAa,sBAAsB,GAAKL,EAAQK,aAAa,iBAAiB,EAClGC,EAAYN,EAAQK,aAAa,sBAAsB,GAAKL,EAAQK,aAAa,iBAAiB,EAClGE,EAAWP,EAAQK,aAAa,yBAAyB,GAAK,KAE7DD,KAIDF,EAAUL,SAASW,eAAeJ,CAAS,KAKvCK,EAAMT,EAAQU,QAAQ,mBAAmB,KAIpCR,GADLA,EAAUO,EAAIE,cAAc,YAAcP,EAAY,KAAK,IAG5CK,EAAIE,cAAc,mBAAqBP,EAAY,6BAA+BA,EAAY,8BAAgCA,EAAY,aAAa,GAMzKF,EAAAA,GACSL,SAASc,cAAc,UAAYP,EAAY,IAAI,KAK7DD,EAAe,GACE,aAAjBD,EAAQU,MACRT,EAAeD,EAAQW,QAAUX,EAAQY,MAAQ,GAE5CZ,EAAQW,SAA6B,QAAlBX,EAAQY,QAAiBX,EAAe,KAKhEA,EAJwB,UAAjBD,EAAQU,MAEXG,EAAYb,EAAQc,MACpBC,EAAepB,SAASc,cAAc,eAAiBI,EAAY,YAAY,GACrDE,EAAaH,MAAQ,IAEpCZ,EAAQY,MAGvBI,EAAU,CAAA,EACG,OAAbX,EACAW,EAAUC,OAAOhB,CAAY,IAAMgB,OAAOb,CAAS,EAC/B,OAAbC,IACPW,EAAUC,OAAOhB,CAAY,IAAMgB,OAAOb,CAAS,GAInDY,GACAlB,EAAQoB,OAAS,CAAA,EAEjBpB,EAAQF,iBAAiB,2BAA2B,EAAEC,QAAQ,SAAUsB,GACpEA,EAAMT,KAAOS,EAAMhB,aAAa,oBAAoB,EACpDgB,EAAMC,gBAAgB,oBAAoB,EAEpCC,EAAavB,EAAQW,cAAc,eAAiBU,EAAML,KAAO,cAAc,EACjFO,GACAA,EAAWC,OAAO,CAE1B,CAAC,IAEDxB,EAAQoB,OAAS,CAAA,EAEjBpB,EAAQF,iBAAiB,4BAA4B,EAAEC,QAAQ,SAAUsB,GACrE,IAIUE,EAJLF,EAAMI,aAAa,oBAAoB,IACxCJ,EAAMK,aAAa,qBAAsBL,EAAMT,IAAI,EACnDS,EAAMT,KAAO,UAEPW,EAAa1B,SAAS8B,cAAc,OAAO,GACtCf,KAAO,SAClBW,EAAWP,KAAOK,EAAML,KAAO,aAC/BO,EAAWT,MAAQ,IACnBd,EAAQ4B,YAAYL,CAAU,EAEtC,CAAC,GAET,CAEA,SAASM,kCACLjC,4BAA4B,EAG5BC,SAASiC,iBAAiB,SAAU,SAASC,GAC5BA,EAAEC,OACJC,QAAQ,yBAAyB,GAGxCrC,4BAA4B,CAEpC,CAAC,CAIL,CAEAC,SAASiC,iBAAiB,mBAAoBD,+BAA+B"}