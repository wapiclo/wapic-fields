{"version":3,"file":"repeater.min.js","sources":["repeater.js"],"sourcesContent":["(function ($) {\n  \"use strict\";\n\n  function getRowCount($wrap) {\n    return $wrap.find(\".wcf-repeater-row:not(.wcf-repeater-template)\").length;\n  }\n\n  function replaceIndexAttrs($el, idx) {\n    $el.find(\"[name]\").each(function () {\n      var name = $(this).attr(\"name\");\n      if (!name) return;\n      $(this).attr(\"name\", name.replace(\"[__INDEX__]\", \"[\" + idx + \"]\"));\n    });\n    $el.find(\"[id]\").each(function () {\n      var id = $(this).attr(\"id\");\n      if (id) $(this).attr(\"id\", id.replace(\"__INDEX__\", String(idx)));\n    });\n    $el.find(\"[aria-controls]\").each(function () {\n      var ac = $(this).attr(\"aria-controls\");\n      if (ac)\n        $(this).attr(\"aria-controls\", ac.replace(\"__INDEX__\", String(idx)));\n    });\n    $el.find(\"[for]\").each(function () {\n      var fr = $(this).attr(\"for\");\n      if (fr) $(this).attr(\"for\", fr.replace(\"__INDEX__\", String(idx)));\n    });\n  }\n\n  function updateRowTitle($row, titleField) {\n    if (!titleField) return;\n    var $input = $row\n      .find('.wcf-repeater-field[data-subfield-id=\"' + titleField + '\"]')\n      .find(\"input, select, textarea\")\n      .first();\n    var val = ($input.val() || \"\").toString().trim();\n    $row.find(\".wcf-repeater-row-title\").text(val !== \"\" ? val : \"Item\");\n  }\n\n  function setOpen($row, open) {\n    var $btn = $row.find(\n      \"> .wcf-repeater-row-header .wcf-repeater-accordion-toggle\"\n    );\n    var $body = $row.find(\"> .wcf-repeater-row-body\");\n    if (open) {\n      $btn.attr(\"aria-expanded\", \"true\");\n      $body.stop(true, true).slideDown(150);\n      $btn.text(\"▲\");\n      $row.addClass(\"is-active\");\n    } else {\n      $btn.attr(\"aria-expanded\", \"false\");\n      $body.stop(true, true).slideUp(150);\n      $btn.text(\"▼\");\n      $row.removeClass(\"is-active\");\n    }\n  }\n\n  function bindRowEvents($wrap, $row, titleField) {\n    if (titleField) {\n      $row.on(\n        \"input change\",\n        '.wcf-repeater-field[data-subfield-id=\"' +\n          titleField +\n          '\"] input, .wcf-repeater-field[data-subfield-id=\"' +\n          titleField +\n          '\"] select, .wcf-repeater-field[data-subfield-id=\"' +\n          titleField +\n          '\"] textarea',\n        function () {\n          updateRowTitle($row, titleField);\n        }\n      );\n      updateRowTitle($row, titleField);\n    }\n    $row.on(\"click\", \".wcf-repeater-accordion-toggle\", function (e) {\n      e.preventDefault();\n      var $btn = $(this);\n      var expanded = $btn.attr(\"aria-expanded\") === \"true\";\n      setOpen($row, !expanded);\n    });\n    // Header click no longer toggles; arrow button only\n    $row.on(\"click\", \".wcf-repeater-remove\", function (e) {\n      e.preventDefault();\n      $row.remove();\n    });\n\n    // Initialize field plugins for this row\n    initRowPlugins($row);\n\n    // Apply required markers from wrapper to inputs (for new rows cloned from template)\n    $row.find('.wcf-repeater-field[data-wcf-required=\"1\"]').each(function () {\n      $(this)\n        .find(\"input, select, textarea\")\n        .each(function () {\n          $(this).attr(\"data-required\", \"true\");\n          if (!$(this).hasClass(\"wcf-required\"))\n            $(this).addClass(\"wcf-required\");\n        });\n    });\n\n    // Keep row error class in sync\n    function updateRowError() {\n      if (\n        $row.find(\".wcf-field.has-field-error, .wcf-field-error:visible\").length\n      ) {\n        $row.addClass(\"has-error\");\n      } else {\n        $row.removeClass(\"has-error\");\n      }\n    }\n    // Initial check and on changes\n    updateRowError();\n    $row.on(\"input change blur\", \"input, select, textarea\", function () {\n      // small delay to let validation handlers run\n      setTimeout(updateRowError, 0);\n    });\n\n    // Media select/clear handlers\n    $row\n      .off(\"click.wcfMedia\")\n      .on(\"click.wcfMedia\", \".wcf-media-select\", function (e) {\n        e.preventDefault();\n        if (!(window.wp && wp.media)) return;\n        var type = $(this).data(\"media-type\") || \"image\";\n        var targetSel = $(this).data(\"target\");\n        var $target = $row.find(targetSel);\n        if (!$target.length) return;\n\n        var frame = wp.media({\n          title: type === \"gallery\" ? \"Select Images\" : \"Select Image\",\n          library: { type: \"image\" },\n          multiple: type === \"gallery\",\n        });\n\n        frame.on(\"select\", function () {\n          if (type === \"gallery\") {\n            var ids = frame\n              .state()\n              .get(\"selection\")\n              .map(function (att) {\n                return att.id;\n              });\n            $target.val(ids.join(\",\")).trigger(\"change\");\n          } else {\n            var att = frame.state().get(\"selection\").first();\n            if (att) {\n              var data = att.toJSON();\n              $target.val(data.url || \"\").trigger(\"change\");\n            }\n          }\n        });\n\n        frame.open();\n      })\n      .on(\"click.wcfMedia\", \".wcf-media-clear\", function (e) {\n        e.preventDefault();\n        var targetSel = $(this).data(\"target\");\n        var $target = $row.find(targetSel);\n        if ($target.length) {\n          $target.val(\"\").trigger(\"change\");\n        }\n      })\n      // Image (ID) uploader similar to core Field::control_image\n      .on(\"click.wcfMedia\", \".wcf-field-image-upload\", function (e) {\n        e.preventDefault();\n        if (!(window.wp && wp.media)) return;\n        var targetId = $(this).data(\"target\");\n        var $hidden = $row.find(\"#\" + targetId);\n        var $preview = $row.find(\"#\" + targetId + \"_preview\");\n        var frame = wp.media({\n          title: \"Select Image\",\n          library: { type: \"image\" },\n          multiple: false,\n        });\n        frame.on(\"select\", function () {\n          var att = frame.state().get(\"selection\").first();\n          if (!att) return;\n          var data = att.toJSON();\n          $hidden.val(data.id || \"\").trigger(\"change\");\n          if ($preview.length) {\n            var html = \"\";\n            if (data.url) {\n              html += '<span class=\"wcf-field-image-thumb\">';\n              html += '<img src=\"' + data.url + '\">';\n              html +=\n                '<a href=\"#\" class=\"wcf-field-remove-image\" title=\"Remove image\">×</a>';\n              html += \"</span>\";\n            }\n            $preview.html(html);\n          }\n        });\n        frame.open();\n      })\n      .on(\"click.wcfMedia\", \".wcf-field-remove-image\", function (e) {\n        e.preventDefault();\n        var $thumb = $(this).closest(\".wcf-field-image-thumb\");\n        var $hidden = $thumb\n          .closest(\".wcf-repeater-row-body\")\n          .find(\"input.wcf-media-id\")\n          .first();\n        $thumb.remove();\n        if ($hidden.length) $hidden.val(\"\").trigger(\"change\");\n      })\n      // Gallery (IDs) uploader similar to core Field::control_gallery\n      .on(\"click.wcfMedia\", \".wcf-field-gallery-upload\", function (e) {\n        e.preventDefault();\n        if (!(window.wp && wp.media)) return;\n        var targetId = $(this).data(\"target\");\n        var $hidden = $row.find(\"#\" + targetId + \".wcf-gallery-ids\");\n        var $preview = $row.find(\"#\" + targetId + \"_preview\");\n        var frame = wp.media({\n          title: \"Select Images\",\n          library: { type: \"image\" },\n          multiple: true,\n        });\n        frame.on(\"select\", function () {\n          var selection = frame.state().get(\"selection\");\n          var ids = selection.map(function (att) {\n            return att.id;\n          });\n          $hidden.val(ids.join(\",\")).trigger(\"change\");\n          if ($preview.length) {\n            var html = \"\";\n            selection.each(function (att) {\n              var d = att.toJSON();\n              var url =\n                d.sizes && d.sizes.thumbnail && d.sizes.thumbnail.url\n                  ? d.sizes.thumbnail.url\n                  : d.url;\n              html +=\n                '<span class=\"wcf-field-gallery-thumb\" data-id=\"' + d.id + '\">';\n              html += '<img src=\"' + url + '\" alt=\"\">';\n              html +=\n                '<a href=\"#\" class=\"wcf-field-remove-gallery-thumb\" title=\"Remove image\">×</a>';\n              html += \"</span>\";\n            });\n            $preview.html(html);\n          }\n        });\n        frame.open();\n      })\n      .on(\"click.wcfMedia\", \".wcf-field-remove-gallery-thumb\", function (e) {\n        e.preventDefault();\n        var $thumb = $(this).closest(\".wcf-field-gallery-thumb\");\n        var id = String($thumb.data(\"id\"));\n        var $wrapBody = $thumb.closest(\".wcf-repeater-row-body\");\n        var $hidden = $wrapBody.find(\"input.wcf-gallery-ids\");\n        $thumb.remove();\n        if ($hidden.length) {\n          var current = ($hidden.val() || \"\").split(\",\").filter(Boolean);\n          var next = current.filter(function (v) {\n            return String(v) !== id;\n          });\n          $hidden.val(next.join(\",\")).trigger(\"change\");\n        }\n      });\n  }\n\n  $(document).ready(function () {\n    $(\".wcf-repeater\").each(function () {\n      var $wrap = $(this);\n      var $form = $wrap.closest(\"form\");\n      if ($form.length && !$form.data(\"wcfPopupBound\")) {\n        $form.on(\"submit.wcfPopup\", function () {\n          // If any field has error, show a generic popup as well\n          if (\n            $(this).find(\".has-field-error, .wcf-field-error:visible\").length\n          ) {\n            try {\n              alert(\"Please fix the highlighted fields.\");\n            } catch (e) {}\n          }\n          // Sync row error classes after validation marks fields\n          var $f = $(this);\n          setTimeout(function () {\n            $f.find(\".wcf-repeater-row\").each(function () {\n              var $r = $(this);\n              if (\n                $r.find(\".wcf-field.has-field-error, .wcf-field-error:visible\")\n                  .length\n              ) {\n                $r.addClass(\"has-error\");\n              } else {\n                $r.removeClass(\"has-error\");\n              }\n            });\n          }, 0);\n        });\n        $form.data(\"wcfPopupBound\", true);\n      }\n      var max = parseInt($wrap.data(\"max\"), 10) || 0;\n      var titleField = ($wrap.data(\"title-field\") || \"\").toString();\n\n      // Make rows sortable\n      if ($.fn.sortable) {\n        $wrap.sortable({\n          items: \"> .wcf-repeater-row:not(.wcf-repeater-template)\",\n          handle: \".wcf-repeater-drag-handle\",\n          axis: \"y\",\n          placeholder: \"wcf-repeater-placeholder\",\n          update: function () {\n            renumberRows($wrap);\n          },\n        });\n      }\n\n      $wrap\n        .find(\".wcf-repeater-row:not(.wcf-repeater-template)\")\n        .each(function () {\n          var $row = $(this);\n          bindRowEvents($wrap, $row, titleField);\n          // ensure collapsed initially via helper (sets icon too)\n          setOpen($row, false);\n        });\n\n      $wrap.on(\"click\", \".wcf-repeater-add\", function (e) {\n        e.preventDefault();\n        var count = getRowCount($wrap);\n        if (max > 0 && count >= max) return;\n\n        // Clone the template row\n        var $tpl = $wrap\n          .find(\".wcf-repeater-template\")\n          .first()\n          .clone(true, true);\n        $tpl.removeClass(\"wcf-repeater-template\").show();\n\n        var idx = count;\n        replaceIndexAttrs($tpl, idx);\n\n        // Reset values\n        $tpl\n          .find(\n            'input[type=\"text\"], input[type=\"email\"], input[type=\"url\"], input[type=\"number\"], input[type=\"hidden\"], input[type=\"date\"]'\n          )\n          .val(\"\");\n        $tpl.find(\"textarea\").val(\"\");\n        $tpl.find(\"select\").each(function () {\n          var $s = $(this);\n          if ($s.prop(\"multiple\")) $s.val([]);\n          else $s.val($s.find(\"option\").first().val() || \"\");\n        });\n\n        // Enable inputs on the cloned row (template had disabled)\n        $tpl\n          .find(\"input, select, textarea\")\n          .prop(\"disabled\", false)\n          .removeAttr(\"disabled\");\n\n        // Add the new row to the DOM\n        $wrap.find(\".wcf-repeater-actions\").before($tpl);\n\n        // Initialize the row\n        bindRowEvents($wrap, $tpl, titleField);\n\n        // Ensure the row is expanded\n        setOpen($tpl, true);\n\n        // Initialize all plugins for this row\n        initRowPlugins($tpl);\n      });\n    });\n  });\n\n  function initRowPlugins($row) {\n    // Initialize Select2\n    if ($.fn.select2) {\n      $row.find(\"select.wcf-repeater-field-select2\").each(function () {\n        var $select = $(this);\n\n        // Destroy any existing Select2 instance\n        if ($select.hasClass(\"select2-hidden-accessible\")) {\n          $select.select2(\"destroy\");\n          $select.next(\".select2-container\").remove();\n        }\n\n        var options = {\n          width: $select.data(\"width\") || \"100%\",\n          placeholder: $select.data(\"placeholder\") || \"\",\n          allowClear:\n            $select.data(\"allow-clear\") === true ||\n            $select.data(\"allow-clear\") === \"true\",\n        };\n\n        try {\n          $select.select2(options).trigger(\"change\");\n        } catch (e) {\n          console.error(\"Error initializing Select2:\", e);\n        }\n      });\n    }\n\n    // Initialize Color Picker\n    if ($.fn.wpColorPicker) {\n      $row.find(\"input.wcf-repeater-field-color\").each(function () {\n        var $input = $(this);\n\n        // Skip if already initialized or if it's a template field\n        if (\n          $input.hasClass(\"wp-color-picker\") ||\n          $input.hasClass(\"wcf-field-color-repeat-template\")\n        ) {\n          return;\n        }\n\n        // Store the current value to prevent unnecessary changes\n        var currentValue = $input.val();\n\n        try {\n          // Initialize color picker with minimal configuration\n          $input.wpColorPicker({\n            defaultColor: currentValue || \"\",\n            change: function (event, ui) {\n              // Only trigger change if the value actually changed\n              if (ui && ui.color && ui.color.toString() !== currentValue) {\n                currentValue = ui.color.toString();\n                $input.trigger(\"change\");\n              }\n            },\n            clear: function () {\n              if (currentValue !== \"\") {\n                currentValue = \"\";\n                $input.trigger(\"change\");\n              }\n            },\n          });\n        } catch (e) {\n          console.error(\"Error initializing Color Picker:\", e);\n        }\n      });\n    }\n\n    // Initialize Datepicker\n    if ($.fn.datepicker) {\n      $row.find(\"input.wcf-field-date\").each(function () {\n        var $dateInput = $(this);\n\n        // Skip if already initialized\n        if ($dateInput.hasClass(\"hasDatepicker\")) {\n          return;\n        }\n\n        try {\n          $dateInput.datepicker({\n            dateFormat: \"yy-mm-dd\",\n            changeMonth: true,\n            changeYear: true,\n            onSelect: function () {\n              $(this).trigger(\"change\");\n            },\n          });\n        } catch (e) {\n          console.error(\"Error initializing Datepicker:\", e);\n        }\n      });\n    }\n\n    // Initialize WP editor for editor textareas if available\n    if (window.wp && wp.editor && typeof wp.editor.initialize === \"function\") {\n      $row.find(\"textarea.wcf-repeater-field-editor\").each(function () {\n        var id = $(this).attr(\"id\");\n        if (id) {\n          try {\n            wp.editor.initialize(id, { tinymce: true, quicktags: true });\n          } catch (e) {}\n        }\n      });\n    }\n  }\n\n  function renumberRows($wrap) {\n    $wrap\n      .find(\"> .wcf-repeater-row:not(.wcf-repeater-template)\")\n      .each(function (i) {\n        var $row = $(this);\n        $row.attr(\"data-index\", i);\n        // ids and controls\n        $row.find(\"[id]\").each(function () {\n          var id = $(this).attr(\"id\");\n          if (!id) return;\n          id = id.replace(/_(?:__INDEX__|\\d+)_/, \"_\" + i + \"_\");\n          $(this).attr(\"id\", id);\n        });\n        $row.find(\"[aria-controls]\").each(function () {\n          var ac = $(this).attr(\"aria-controls\");\n          if (ac)\n            $(this).attr(\n              \"aria-controls\",\n              ac.replace(/_(?:__INDEX__|\\d+)_/, \"_\" + i + \"_\")\n            );\n        });\n        $row.find(\"[for]\").each(function () {\n          var fr = $(this).attr(\"for\");\n          if (fr)\n            $(this).attr(\n              \"for\",\n              fr.replace(/_(?:__INDEX__|\\d+)_/, \"_\" + i + \"_\")\n            );\n        });\n        // names\n        $row.find(\"[name]\").each(function () {\n          var name = $(this).attr(\"name\");\n          if (!name) return;\n          name = name.replace(/\\[[0-9]+\\]/, \"[\" + i + \"]\");\n          $(this).attr(\"name\", name);\n        });\n      });\n  }\n})(jQuery);\n"],"names":["$","updateRowTitle","$row","titleField","val","find","first","toString","trim","text","setOpen","open","$btn","$body","attr","stop","slideDown","addClass","slideUp","removeClass","bindRowEvents","$wrap","updateRowError","length","on","e","preventDefault","expanded","this","remove","initRowPlugins","each","hasClass","setTimeout","off","type","$target","frame","window","wp","media","data","targetSel","title","library","multiple","ids","state","get","map","att","id","join","trigger","toJSON","url","$hidden","$preview","targetId","html","$thumb","closest","selection","d","sizes","thumbnail","String","next","split","filter","Boolean","v","fn","select2","$select","options","width","placeholder","allowClear","console","error","wpColorPicker","$input","currentValue","defaultColor","change","event","ui","color","clear","datepicker","$dateInput","dateFormat","changeMonth","changeYear","onSelect","editor","initialize","tinymce","quicktags","document","ready","$form","max","alert","$f","$r","parseInt","sortable","items","handle","axis","update","i","replace","ac","fr","name","$tpl","idx","count","clone","show","$el","$s","prop","removeAttr","before","jQuery"],"mappings":"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"}