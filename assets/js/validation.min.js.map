{"version":3,"file":"validation.min.js","sources":["validation.js"],"sourcesContent":["(function () {\n    /*------------------------------------------------\n   | Helpers\n   ------------------------------------------------*/\n    function showError(input, message) {\n        var field = input.closest('.wcf-field');\n        var error = document.getElementById(input.id + '_error');\n        if (!error) return;\n\n        field.classList.add('has-field-error');\n        error.textContent = message;\n        error.style.display = 'block';\n    }\n\n    function clearError(input) {\n        var field = input.closest('.wcf-field');\n        var error = document.getElementById(input.id + '_error');\n        if (!error) return;\n\n        field.classList.remove('has-field-error');\n        error.textContent = '';\n        error.style.display = 'none';\n    }\n\n    function isNumber(val) {\n        return /^\\d+(\\.\\d+)?$/.test(val.trim());\n    }\n\n    function isEmail(val) {\n        return /^\\S+@\\S+\\.\\S+$/.test(val.trim());\n    }\n\n    function isURL(val) {\n        return /^https?:\\/\\//i.test(val) || /^#[\\w-]*$/.test(val);\n    }\n\n    /*------------------------------------------------\n    | Field Validation\n    ------------------------------------------------*/\n    function validateField(input) {\n        var val = input.value.trim();\n        var required = input.hasAttribute('required') || input.hasAttribute('data-required');\n\n        // Required check\n        if (required && val === '') {\n            showError(input, wapic_field.validation.requiredMessage);\n            return false;\n        }\n\n        // Skip if empty and not required\n        if (val === '') {\n            clearError(input);\n            return true;\n        }\n\n        // Email\n        if (input.classList.contains('wcf-field-email') && !isEmail(val)) {\n            showError(input, wapic_field.validation.validEmail);\n            return false;\n        }\n\n        // Number / Phone\n        if (input.classList.contains('wcf-field-number') || input.classList.contains('wcf-field-phone')) {\n            if (!isNumber(val)) {\n                showError(input, wapic_field.validation.validNumber);\n                return false;\n            }\n            const min = input.getAttribute('min');\n            const max = input.getAttribute('max');\n            const numVal = parseFloat(val);\n            if (min !== null && numVal < parseFloat(min)) {\n                showError(input, wapic_field.validation.minNumber.replace('%s', min));\n                return false;\n            }\n            if (max !== null && numVal > parseFloat(max)) {\n                showError(input, wapic_field.validation.maxNumber.replace('%s', max));\n                return false;\n            }\n        }\n\n        // URL\n        if (input.classList.contains('wcf-field-url') && !isURL(val)) {\n            showError(input, wapic_field.validation.validUrl);\n            return false;\n        }\n\n        // File URL\n        if (input.classList.contains('wcf-field-file-url') && !isURL(val)) {\n            showError(input, wapic_field.validation.validUrl);\n            return false;\n        }\n\n        // Price compare\n        var isRegular = input.closest('.wcf-field').classList.contains('regular-price');\n        var isSale = input.closest('.wcf-field').classList.contains('sale-price');\n\n        if (isRegular || isSale) {\n            var regularInput = document.querySelector('.regular-price input');\n            var saleInput = document.querySelector('.sale-price input');\n\n            showError(regularInput, wapic_field.validation.compareRegularPrice);\n            showError(saleInput, wapic_field.validation.compareSalePrice);\n\n            if (regularInput && saleInput && isNumber(regularInput.value) && isNumber(saleInput.value)) {\n                if (parseFloat(saleInput.value) > parseFloat(regularInput.value)) {\n                    showError(regularInput, wapic_field.validation.compareRegularPrice);\n                    showError(saleInput, wapic_field.validation.compareSalePrice);\n                    return false;\n                } else {\n                    clearError(regularInput);\n                    clearError(saleInput);\n                }\n            }\n        }\n\n        clearError(input);\n        return true;\n    }\n\n    /*------------------------------------------------\n    | Form Submit Handler\n    ------------------------------------------------*/\n    function handleFormSubmit(e) {\n        var form = e.target;\n        var inputs = form.querySelectorAll('.wcf-field input');\n        var allValid = true;\n        var errorMessages = [];\n\n        inputs.forEach(function (input) {\n            if (!validateField(input)) {\n                allValid = false;\n\n                var errorElement = document.getElementById(input.id + '_error');\n                var errorText = errorElement ? errorElement.textContent.trim() : '';\n\n                var labelEl = document.querySelector('label[for=\"' + input.id + '\"]');\n                var labelText = labelEl ? labelEl.textContent.trim() : input.name || input.id;\n\n                if (errorText !== '') {\n                    errorMessages.push(labelText + ': ' + errorText);\n                }\n            }\n        });\n\n        if (!allValid) {\n            e.preventDefault();\n\n            // remove duplicate messages\n            errorMessages = [...new Set(errorMessages)];\n\n            var globalMessage = wapic_field.validation.submitFailed + '\\n\\n' +\n                errorMessages.map(function (msg, i) {\n                    return (i + 1) + '. ' + msg;\n                }).join('\\n');\n\n            alert(globalMessage);\n\n            var firstError = form.querySelector('.has-field-error');\n            if (firstError) {\n                firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });\n            }\n        }\n    }\n\n    /*------------------------------------------------\n    | Init\n    ------------------------------------------------*/\n    function formValidationInit() {\n        // Event delegation for input changes\n        document.addEventListener('input', function (e) {\n            if (e.target.matches('.wcf-field input')) {\n                validateField(e.target);\n            }\n        });\n\n        // Handle submit validation\n        document.querySelectorAll('form#post, form#option, form#addtag, form#edittag').forEach(function (form) {\n            form.addEventListener('submit', handleFormSubmit);\n        });\n\n        // Initial validation on page load\n        document.querySelectorAll('.wcf-field input').forEach(validateField);\n    }\n\n    document.addEventListener('DOMContentLoaded', formValidationInit);\n})();\n"],"names":["showError","input","message","field","closest","error","document","getElementById","id","classList","add","textContent","style","display","clearError","remove","isNumber","val","test","trim","isURL","validateField","value","hasAttribute","wapic_field","validation","requiredMessage","contains","validEmail","validNumber","min","getAttribute","max","numVal","parseFloat","minNumber","replace","maxNumber","validUrl","isRegular","isSale","regularInput","querySelector","saleInput","compareRegularPrice","compareSalePrice","handleFormSubmit","e","form","target","inputs","querySelectorAll","allValid","errorMessages","forEach","errorText","labelText","errorElement","labelEl","name","push","preventDefault","Set","globalMessage","submitFailed","map","msg","i","join","alert","firstError","scrollIntoView","behavior","block","addEventListener","matches"],"mappings":"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"}