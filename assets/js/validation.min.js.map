{"version":3,"file":"validation.min.js","sources":["validation.js"],"sourcesContent":["class WapicFieldValidation {\n    constructor() {\n        this.init();\n    }\n\n    /*------------------------------------------------\n    | Helpers\n    ------------------------------------------------*/\n    showError(input, message) {\n        const field = input.closest('.wcf-field');\n        const error = document.getElementById(`${input.id}_error`);\n        if (!error) return;\n\n        field.classList.add('has-field-error');\n        error.textContent = message;\n        error.style.display = 'block';\n    }\n\n    clearError(input) {\n        const field = input.closest('.wcf-field');\n        const error = document.getElementById(`${input.id}_error`);\n        if (!error) return;\n\n        field.classList.remove('has-field-error');\n        error.textContent = '';\n        error.style.display = 'none';\n    }\n\n    isNumber(val) {\n        return /^\\d+(\\.\\d+)?$/.test(val.trim());\n    }\n\n    isEmail(val) {\n        return /^\\S+@\\S+\\.\\S+$/.test(val.trim());\n    }\n\n    isURL(val) {\n        return /^https?:\\/\\//i.test(val) || /^#[\\w-]*$/.test(val);\n    }\n\n    /*------------------------------------------------\n    | Field Validation\n    ------------------------------------------------*/\n    validateField(input) {\n        const val = input.value.trim();\n        const required = input.hasAttribute('required') || input.hasAttribute('data-required');\n\n        // Required check\n        if (required && val === '') {\n            this.showError(input, wapic_field.validation.requiredMessage);\n            return false;\n        }\n\n        // Skip if empty and not required\n        if (val === '') {\n            this.clearError(input);\n            return true;\n        }\n\n        // Email\n        if (input.classList.contains('wcf-field-email') && !this.isEmail(val)) {\n            this.showError(input, wapic_field.validation.validEmail);\n            return false;\n        }\n\n        // Number / Phone\n        if (input.classList.contains('wcf-field-number') || input.classList.contains('wcf-field-phone')) {\n            if (!this.isNumber(val)) {\n                this.showError(input, wapic_field.validation.validNumber);\n                return false;\n            }\n            const min = input.getAttribute('min');\n            const max = input.getAttribute('max');\n            const numVal = parseFloat(val);\n            if (min !== null && numVal < parseFloat(min)) {\n                this.showError(input, wapic_field.validation.minNumber.replace('%s', min));\n                return false;\n            }\n            if (max !== null && numVal > parseFloat(max)) {\n                this.showError(input, wapic_field.validation.maxNumber.replace('%s', max));\n                return false;\n            }\n        }\n\n        // URL\n        if (input.classList.contains('wcf-field-url') && !this.isURL(val)) {\n            this.showError(input, wapic_field.validation.validUrl);\n            return false;\n        }\n\n        // File URL\n        if (input.classList.contains('wcf-field-file-url') && !this.isURL(val)) {\n            this.showError(input, wapic_field.validation.validUrl);\n            return false;\n        }\n\n        // Price compare\n        const isRegular = input.closest('.wcf-field').classList.contains('regular-price');\n        const isSale = input.closest('.wcf-field').classList.contains('sale-price');\n\n        if (isRegular || isSale) {\n            const regularInput = document.querySelector('.regular-price input');\n            const saleInput = document.querySelector('.sale-price input');\n\n            this.showError(regularInput, wapic_field.validation.compareRegularPrice);\n            this.showError(saleInput, wapic_field.validation.compareSalePrice);\n\n            if (regularInput && saleInput && this.isNumber(regularInput.value) && this.isNumber(saleInput.value)) {\n                if (parseFloat(saleInput.value) > parseFloat(regularInput.value)) {\n                    this.showError(regularInput, wapic_field.validation.compareRegularPrice);\n                    this.showError(saleInput, wapic_field.validation.compareSalePrice);\n                    return false;\n                } else {\n                    this.clearError(regularInput);\n                    this.clearError(saleInput);\n                }\n            }\n        }\n\n        this.clearError(input);\n        return true;\n    }\n\n    /*------------------------------------------------\n    | Form Submit Handler\n    ------------------------------------------------*/\n    handleFormSubmit(e) {\n        const form = e.target;\n        const inputs = form.querySelectorAll('.wcf-field input, .wcf-field textarea, .wcf-field select');\n        let allValid = true;\n        let errorMessages = [];\n\n        inputs.forEach((input) => {\n            if (!this.validateField(input)) {\n                allValid = false;\n\n                const errorElement = document.getElementById(`${input.id}_error`);\n                const errorText = errorElement ? errorElement.textContent.trim() : '';\n\n                const labelEl = document.querySelector(`label[for=\"${input.id}\"]`);\n                const labelText = labelEl ? labelEl.textContent.trim() : input.name || input.id;\n\n                if (errorText !== '') {\n                    errorMessages.push(`${labelText}: ${errorText}`);\n                }\n            }\n        });\n\n        if (!allValid) {\n            e.preventDefault();\n\n            // Remove duplicate messages\n            errorMessages = [...new Set(errorMessages)];\n\n            const globalMessage = `${wapic_field.validation.submitFailed}\\n\\n${\n                errorMessages.map((msg, i) => `${i + 1}. ${msg}`).join('\\n')\n            }`;\n\n            alert(globalMessage);\n\n            const firstError = form.querySelector('.has-field-error');\n            if (firstError) {\n                firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });\n            }\n        }\n    }\n\n    /*------------------------------------------------\n    | Event Handlers\n    ------------------------------------------------*/\n    onInputChange(e) {\n        if (e.target.matches('.wcf-field input, .wcf-field textarea, .wcf-field select')) {\n            this.validateField(e.target);\n        }\n    }\n\n    onFormSubmit(e) {\n        this.handleFormSubmit(e);\n    }\n\n    /*------------------------------------------------\n    | Initialization\n    ------------------------------------------------*/\n    init() {\n        // Event delegation for input changes\n        document.addEventListener('input', this.onInputChange.bind(this));\n\n        // Handle submit validation\n        document.querySelectorAll('form#post, form#option, form#addtag, form#edittag').forEach((form) => {\n            form.addEventListener('submit', (e) => this.onFormSubmit(e));\n        });\n\n        // Initial validation on page load\n        document.querySelectorAll('.wcf-field input, .wcf-field textarea, .wcf-field select').forEach((input) => this.validateField(input));\n    }\n}\n\n// Initialize on DOM ready\ndocument.addEventListener('DOMContentLoaded', () => {\n    new WapicFieldValidation();\n});\n"],"names":["WapicFieldValidation","constructor","this","init","showError","input","message","field","closest","error","document","getElementById","id","classList","add","textContent","style","display","clearError","remove","isNumber","val","test","trim","isEmail","isURL","validateField","value","hasAttribute","wapic_field","validation","requiredMessage","contains","validEmail","validNumber","min","getAttribute","max","numVal","parseFloat","minNumber","replace","maxNumber","validUrl","isRegular","isSale","regularInput","querySelector","saleInput","compareRegularPrice","compareSalePrice","handleFormSubmit","e","form","target","inputs","querySelectorAll","let","allValid","errorMessages","forEach","errorText","labelText","errorElement","labelEl","name","push","preventDefault","Set","globalMessage","submitFailed","map","msg","i","join","alert","firstError","scrollIntoView","behavior","block","onInputChange","matches","onFormSubmit","addEventListener","bind"],"mappings":"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"}