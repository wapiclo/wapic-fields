(c=>{function n(e,t){var a;t&&0<(a=0===(a=0===(a=e.find('[data-subfield-id="'+t+'"]').find("input, select, textarea").first()).length&&void 0!==e.data("index")?e.find('[name$="['+t+']"]').first():a).length?e.find('[name$="[title]"], [name$="[title][]"]').first():a).length&&(t=(a.val()||"").toString().trim(),e.find(".wcf-repeater-row-title").text(""!==t?t:"Item"))}function o(e,t){var a=e.find("> .wcf-repeater-row-header .wcf-repeater-accordion-toggle"),i=e.find("> .wcf-repeater-row-body");t?(a.attr("aria-expanded","true"),i.stop(!0,!0).slideDown(150),a.text("▲"),e.addClass("is-active")):(a.attr("aria-expanded","false"),i.stop(!0,!0).slideUp(150),a.text("▼"),e.removeClass("is-active"))}function d(e,t,a){var i;function r(){t.find(".wcf-field.has-field-error, .wcf-field-error:visible").length?t.addClass("has-error"):t.removeClass("has-error")}a&&(i=['[data-subfield-id="'+a+'"] input','[data-subfield-id="'+a+'"] select','[data-subfield-id="'+a+'"] textarea','[name$="['+a+']"], [name$="['+a+'][]"]','[name$="[title]"], [name$="[title][]"]'].join(", "),t.on("input change",i,function(){n(t,a)}),n(t,a)),t.on("click",".wcf-repeater-accordion-toggle",function(e){e.preventDefault();e="true"===c(this).attr("aria-expanded");o(t,!e)}),t.on("click",".wcf-repeater-remove",function(e){e.preventDefault(),t.remove()}),l(t),t.find('.wcf-repeater-field[data-wcf-required="1"]').each(function(){c(this).find("input, select, textarea").each(function(){c(this).attr("data-required","true"),c(this).hasClass("wcf-required")||c(this).addClass("wcf-required")})}),r(),t.on("input change blur","input, select, textarea",function(){setTimeout(r,0)})}function l(e){"function"==typeof WapicFieldMediaUploader&&new WapicFieldMediaUploader,"function"==typeof WapicFieldColorPickerInit&&WapicFieldColorPickerInit(),"function"==typeof WapicFieldSelect2Init&&WapicFieldSelect2Init(),"function"==typeof WapicFieldDatePickerInit&&WapicFieldDatePickerInit(),"undefined"!=typeof wp&&wp.editor&&e.find(".wcf-field-editor").each(function(){var e=c(this).attr("id");try{wp.editor.remove(e)}catch(e){}wp.editor.initialize(e,{tinymce:{wpautop:!0,toolbar1:"bold italic underline | alignleft aligncenter alignright"},quicktags:!0})}),"function"==typeof WapicFieldConditionalFields&&new WapicFieldConditionalFields,"function"==typeof WapicFieldValidation&&new WapicFieldValidation}c(document).ready(function(){c(".wcf-repeater").each(function(){var i=c(this),r=parseInt(i.data("max"),10)||0,n=(i.data("title-field")||"").toString();c.fn.sortable&&i.sortable({items:"> .wcf-repeater-row:not(.wcf-repeater-template)",handle:".wcf-repeater-drag-handle",axis:"y",placeholder:"wcf-repeater-placeholder",update:function(){i.find("> .wcf-repeater-row:not(.wcf-repeater-template)").each(function(t){var e=c(this);e.attr("data-index",t),e.find("[id]").each(function(){var e=c(this).attr("id");e&&(e=e.replace(/_(?:__INDEX__|\d+)_/,"_"+t+"_"),c(this).attr("id",e))}),e.find("[aria-controls]").each(function(){var e=c(this).attr("aria-controls");e&&c(this).attr("aria-controls",e.replace(/_(?:__INDEX__|\d+)_/,"_"+t+"_"))}),e.find("[for]").each(function(){var e=c(this).attr("for");e&&c(this).attr("for",e.replace(/_(?:__INDEX__|\d+)_/,"_"+t+"_"))}),e.find("[name]").each(function(){var e=c(this).attr("name");e&&(e=e.replace(/\[[0-9]+\]/,"["+t+"]"),c(this).attr("name",e))})})}}),i.find(".wcf-repeater-row:not(.wcf-repeater-template)").each(function(){var e=c(this);d(0,e,n),o(e,!1)}),i.on("click",".wcf-repeater-add",function(e){e.preventDefault();var t,a,e=i.find(".wcf-repeater-row:not(.wcf-repeater-template)").length;0<r&&r<=e||((t=i.find(".wcf-repeater-template").first().clone(!0,!0)).removeClass("wcf-repeater-template").show(),t.find('[class*="wcf-repeater-field"]').each(function(){var e=c(this),t=e.attr("class").split(" ").filter(e=>!e.includes("wcf-repeater-field"));e.attr("class",t.join(" ").trim()||"")}),a=e,(e=t).find("[name]").each(function(){var e=c(this).attr("name");e&&c(this).attr("name",e.replace("[__INDEX__]","["+a+"]"))}),e.find("[id]").each(function(){var e=c(this).attr("id");e&&c(this).attr("id",e.replace("__INDEX__",String(a)))}),e.find("[aria-controls]").each(function(){var e=c(this).attr("aria-controls");e&&c(this).attr("aria-controls",e.replace("__INDEX__",String(a)))}),e.find("[for]").each(function(){var e=c(this).attr("for");e&&c(this).attr("for",e.replace("__INDEX__",String(a)))}),e.find("[data-target]").each(function(){var e=c(this).attr("data-target");e&&c(this).attr("data-target",e.replace("__INDEX__",String(a)))}),t.find('input[type="text"], input[type="email"], input[type="url"], input[type="number"], input[type="hidden"], input[type="date"]').val(""),t.find("textarea").val(""),t.find("select").each(function(){var e=c(this);e.prop("multiple")?e.val([]):e.val(e.find("option").first().val()||"")}),t.find("input, select, textarea").prop("disabled",!1).removeAttr("disabled"),i.find(".wcf-repeater-actions").before(t),d(0,t,n),o(t,!0),l(t))})}),document.querySelectorAll("form#post, form#option, form#addtag, form#edittag").forEach(e=>{e.addEventListener("submit",e=>{let a=!1,i=[];document.querySelectorAll(".wcf-field-type-repeater").forEach(e=>{var t=e.querySelector("label").textContent.trim()||"Repeater Field";e.querySelector(".has-error")&&(a=!0,i.push(`- ${t} has invalid fields`))}),a&&(e.preventDefault(),e=[...new Set(i)],alert("Please fix the following errors:\n\n"+e.join("\n")))})})})})(jQuery);
//# sourceMappingURL=repeater.min.js.map
