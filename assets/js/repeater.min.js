(c=>{function r(e,t){t&&(t=(e.find('.wcf-repeater-field[data-subfield-id="'+t+'"]').find("input, select, textarea").first().val()||"").toString().trim(),e.find(".wcf-repeater-row-title").text(""!==t?t:"Item"))}function f(e,t){var a=e.find("> .wcf-repeater-row-header .wcf-repeater-accordion-toggle"),i=e.find("> .wcf-repeater-row-body");t?(a.attr("aria-expanded","true"),i.stop(!0,!0).slideDown(150),a.text("▲"),e.addClass("is-active")):(a.attr("aria-expanded","false"),i.stop(!0,!0).slideUp(150),a.text("▼"),e.removeClass("is-active"))}function d(e,t,a){function i(){t.find(".wcf-field.has-field-error, .wcf-field-error:visible").length?t.addClass("has-error"):t.removeClass("has-error")}a&&(t.on("input change",'.wcf-repeater-field[data-subfield-id="'+a+'"] input, .wcf-repeater-field[data-subfield-id="'+a+'"] select, .wcf-repeater-field[data-subfield-id="'+a+'"] textarea',function(){r(t,a)}),r(t,a)),t.on("click",".wcf-repeater-accordion-toggle",function(e){e.preventDefault();e="true"===c(this).attr("aria-expanded");f(t,!e)}),t.on("click",".wcf-repeater-remove",function(e){e.preventDefault(),t.remove()}),o(t),t.find('.wcf-repeater-field[data-wcf-required="1"]').each(function(){c(this).find("input, select, textarea").each(function(){c(this).attr("data-required","true"),c(this).hasClass("wcf-required")||c(this).addClass("wcf-required")})}),i(),t.on("input change blur","input, select, textarea",function(){setTimeout(i,0)})}function o(e){"function"==typeof wapicFieldMediaUploader&&new wapicFieldMediaUploader,"function"==typeof wapiFieldColorPickerInit&&wapiFieldColorPickerInit(),"function"==typeof wapicFieldSelect2Init&&wapicFieldSelect2Init(),"function"==typeof wapicFieldDatePickerInit&&wapicFieldDatePickerInit(),"undefined"!=typeof wp&&wp.editor&&e.find(".wcf-field-editor").each(function(){var e=c(this).attr("id");try{wp.editor.remove(e)}catch(e){}wp.editor.initialize(e,{tinymce:{wpautop:!0,toolbar1:"bold italic underline | alignleft aligncenter alignright"},quicktags:!0})})}c(document).ready(function(){c(".wcf-repeater").each(function(){var i=c(this),e=i.closest("form"),r=(e.length&&!e.data("wcfPopupBound")&&(e.on("submit.wcfPopup",function(){if(c(this).find(".has-field-error, .wcf-field-error:visible").length)try{alert("Please fix the highlighted fields.")}catch(e){}var e=c(this);setTimeout(function(){e.find(".wcf-repeater-row").each(function(){var e=c(this);e.find(".wcf-field.has-field-error, .wcf-field-error:visible").length?e.addClass("has-error"):e.removeClass("has-error")})},0)}),e.data("wcfPopupBound",!0)),parseInt(i.data("max"),10)||0),n=(i.data("title-field")||"").toString();c.fn.sortable&&i.sortable({items:"> .wcf-repeater-row:not(.wcf-repeater-template)",handle:".wcf-repeater-drag-handle",axis:"y",placeholder:"wcf-repeater-placeholder",update:function(){i.find("> .wcf-repeater-row:not(.wcf-repeater-template)").each(function(t){var e=c(this);e.attr("data-index",t),e.find("[id]").each(function(){var e=c(this).attr("id");e&&(e=e.replace(/_(?:__INDEX__|\d+)_/,"_"+t+"_"),c(this).attr("id",e))}),e.find("[aria-controls]").each(function(){var e=c(this).attr("aria-controls");e&&c(this).attr("aria-controls",e.replace(/_(?:__INDEX__|\d+)_/,"_"+t+"_"))}),e.find("[for]").each(function(){var e=c(this).attr("for");e&&c(this).attr("for",e.replace(/_(?:__INDEX__|\d+)_/,"_"+t+"_"))}),e.find("[name]").each(function(){var e=c(this).attr("name");e&&(e=e.replace(/\[[0-9]+\]/,"["+t+"]"),c(this).attr("name",e))})})}}),i.find(".wcf-repeater-row:not(.wcf-repeater-template)").each(function(){var e=c(this);d(0,e,n),f(e,!1)}),i.on("click",".wcf-repeater-add",function(e){e.preventDefault();var t,a,e=i.find(".wcf-repeater-row:not(.wcf-repeater-template)").length;0<r&&r<=e||((t=i.find(".wcf-repeater-template").first().clone(!0,!0)).removeClass("wcf-repeater-template").show(),t.find('[class*="wcf-repeater-field"]').each(function(){var e=c(this),t=e.attr("class").split(" ").filter(e=>!e.includes("wcf-repeater-field"));e.attr("class",t.join(" ").trim()||"")}),a=e,(e=t).find("[name]").each(function(){var e=c(this).attr("name");e&&c(this).attr("name",e.replace("[__INDEX__]","["+a+"]"))}),e.find("[id]").each(function(){var e=c(this).attr("id");e&&c(this).attr("id",e.replace("__INDEX__",String(a)))}),e.find("[aria-controls]").each(function(){var e=c(this).attr("aria-controls");e&&c(this).attr("aria-controls",e.replace("__INDEX__",String(a)))}),e.find("[for]").each(function(){var e=c(this).attr("for");e&&c(this).attr("for",e.replace("__INDEX__",String(a)))}),e.find("[data-target]").each(function(){var e=c(this).attr("data-target");e&&c(this).attr("data-target",e.replace("__INDEX__",String(a)))}),t.find('input[type="text"], input[type="email"], input[type="url"], input[type="number"], input[type="hidden"], input[type="date"]').val(""),t.find("textarea").val(""),t.find("select").each(function(){var e=c(this);e.prop("multiple")?e.val([]):e.val(e.find("option").first().val()||"")}),t.find("input, select, textarea").prop("disabled",!1).removeAttr("disabled"),i.find(".wcf-repeater-actions").before(t),d(0,t,n),f(t,!0),o(t))})})})})(jQuery);
//# sourceMappingURL=repeater.min.js.map
